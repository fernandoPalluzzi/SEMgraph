# SEMgraph

## Overview

**SEMgraph** estimates networks and causal relations in complex systems
through Structural Equation Modeling (SEM). **SEMgraph** runs with a
directed graph (adjacency matrix) that encodes the hypothesized or
data-driven causal links among variables. It comes with the following
functionalities:

- Interchangeable model representation as either an **igraph** object or
  the corresponding SEM in **lavaan** syntax. Model management functions
  include graph-to-SEM conversion, automated covariance matrix
  regularization, graph conversion to DAG, and tree (arborescence) from
  correlation matrices.

- Heuristic filtering, node and edge weighting, resampling and
  parallelization settings for fast fitting in case of very large
  models.

- Automated data-driven model building and improvement, through causal
  structure learning and bow-free interaction search and latent variable
  confounding adjustment.

- Perturbed paths finding, community searching and sample scoring,
  together with graph plotting utilities, tracing model architecture
  modifications and perturbation (i.e., activation or repression)
  routes.

## Installation

The latest stable version can be installed from CRAN:

``` r
install.packages("SEMgraph")
```

The latest development version can be installed from GitHub:

``` r
# install.packages("devtools")
devtools::install_github("fernandoPalluzzi/SEMgraph")
```

## References

Grassi M, Palluzzi F, Tarantino B. **SEMgraph: an R package for causal
network inference of high-throughput data with structural equation
models**. Bioinformatics, 2022 Aug 30; 38(20):btac567.
<https://doi.org/10.1093/bioinformatics/btac567>

Grassi M, Tarantino B. **SEMgsa: topology-based pathway enrichment
analysis with structural equation models**. BMC Bioinformatics, 2022 Aug
17; 23(1):344. <https://doi.org/10.1186/s12859-022-04884-8>

Grassi M, Tarantino B. **SEMtree: tree-based structure learning methods
with structural equation models**. Bioinformatics, 2023 June 09;
39(6):btad377. <https://doi.org/10.1093/bioinformatics/btad377>

Grassi M, Tarantino B. **SEMbap: Bow-free covariance search and data
de-correlation**. PLoS Comput Biol, 2024 Sep 11; 20(9):e1012448.
<https://doi.org/10.1371/journal.pcbi.1012448>

Grassi M, Tarantino B. **SEMdag: Fast learning of Directed Acyclic
Graphs via node or layer ordering**. PLoS ONE. 2025 Jan 08; 20(1):
e0317283. <https://doi.org/10.1371/journal.pone.0317283>

# Package index

## All functions

- [`alsData`](https://grassiMario.github.io/SEMgraph/reference/alsData.md)
  : Amyotrophic Lateral Sclerosis (ALS) dataset
- [`ancestors()`](https://grassiMario.github.io/SEMgraph/reference/ancestry.md)
  [`descendants()`](https://grassiMario.github.io/SEMgraph/reference/ancestry.md)
  [`parents()`](https://grassiMario.github.io/SEMgraph/reference/ancestry.md)
  [`siblings()`](https://grassiMario.github.io/SEMgraph/reference/ancestry.md)
  : Node ancestry utilities
- [`clusterGraph()`](https://grassiMario.github.io/SEMgraph/reference/clusterGraph.md)
  : Topological graph clustering
- [`clusterScore()`](https://grassiMario.github.io/SEMgraph/reference/clusterScore.md)
  : Module scoring
- [`colorGraph()`](https://grassiMario.github.io/SEMgraph/reference/colorGraph.md)
  : Vertex and edge graph coloring on the base of fitting
- [`cplot()`](https://grassiMario.github.io/SEMgraph/reference/cplot.md)
  : Subgraph mapping
- [`dagitty2graph()`](https://grassiMario.github.io/SEMgraph/reference/dagitty2graph.md)
  : Graph conversion from dagitty to igraph
- [`extractClusters()`](https://grassiMario.github.io/SEMgraph/reference/extractClusters.md)
  : Cluster extraction utility
- [`factor.analysis()`](https://grassiMario.github.io/SEMgraph/reference/factor.analysis.md)
  : Factor analysis for high dimensional data
- [`gplot()`](https://grassiMario.github.io/SEMgraph/reference/gplot.md)
  : Graph plotting with renderGraph
- [`graph2dag()`](https://grassiMario.github.io/SEMgraph/reference/graph2dag.md)
  : Convert directed graphs to directed acyclic graphs (DAGs)
- [`graph2dagitty()`](https://grassiMario.github.io/SEMgraph/reference/graph2dagitty.md)
  : Graph conversion from igraph to dagitty
- [`graph2lavaan()`](https://grassiMario.github.io/SEMgraph/reference/graph2lavaan.md)
  : Graph to lavaan model
- [`kegg.pathways`](https://grassiMario.github.io/SEMgraph/reference/kegg.pathways.md)
  : KEGG pathways
- [`kegg`](https://grassiMario.github.io/SEMgraph/reference/kegg.md) :
  KEGG interactome
- [`lavaan2graph()`](https://grassiMario.github.io/SEMgraph/reference/lavaan2graph.md)
  : lavaan model to graph
- [`loadPathways()`](https://grassiMario.github.io/SEMgraph/reference/loadPathways.md)
  : Import pathways and generate a reference network
- [`localCI.test()`](https://grassiMario.github.io/SEMgraph/reference/localCI.test.md)
  : Conditional Independence (CI) local tests of an acyclic graph
- [`mergeNodes()`](https://grassiMario.github.io/SEMgraph/reference/mergeNodes.md)
  : Graph nodes merging by a membership attribute
- [`modelSearch()`](https://grassiMario.github.io/SEMgraph/reference/modelSearch.md)
  : Optimal model search strategies
- [`orientEdges()`](https://grassiMario.github.io/SEMgraph/reference/orientEdges.md)
  : Assign edge orientation of an undirected graph
- [`pairwiseMatrix()`](https://grassiMario.github.io/SEMgraph/reference/pairwiseMatrix.md)
  : Pairwise plotting of multivariate data
- [`parameterEstimates()`](https://grassiMario.github.io/SEMgraph/reference/parameterEstimates.md)
  : Parameter Estimates of a fitted SEM
- [`pathFinder()`](https://grassiMario.github.io/SEMgraph/reference/pathFinder.md)
  : Perturbed path search utility
- [`properties()`](https://grassiMario.github.io/SEMgraph/reference/properties.md)
  : Graph properties summary and graph decomposition
- [`resizeGraph()`](https://grassiMario.github.io/SEMgraph/reference/resizeGraph.md)
  : Interactome-assisted graph re-seizing
- [`sachs`](https://grassiMario.github.io/SEMgraph/reference/sachs.md) :
  Sachs multiparameter flow cytometry data and consensus model
- [`SEMace()`](https://grassiMario.github.io/SEMgraph/reference/SEMace.md)
  : Compute the Average Causal Effect (ACE) for a given source-sink pair
- [`SEMbap()`](https://grassiMario.github.io/SEMgraph/reference/SEMbap.md)
  : Bow-free covariance search and data de-correlation
- [`SEMdag()`](https://grassiMario.github.io/SEMgraph/reference/SEMdag.md)
  : Estimate a DAG from an input (or empty) graph
- [`SEMdci()`](https://grassiMario.github.io/SEMgraph/reference/SEMdci.md)
  : SEM-based differential network analysis
- [`SEMgsa()`](https://grassiMario.github.io/SEMgraph/reference/SEMgsa.md)
  : SEM-based gene set analysis
- [`SEMpath()`](https://grassiMario.github.io/SEMgraph/reference/SEMpath.md)
  : Search for directed or shortest paths between pairs of source-sink
  nodes
- [`SEMrun()`](https://grassiMario.github.io/SEMgraph/reference/SEMrun.md)
  : Fit a graph as a Structural Equation Model (SEM)
- [`SEMtree()`](https://grassiMario.github.io/SEMgraph/reference/SEMtree.md)
  : Tree-based structure learning methods
- [`Shipley.test()`](https://grassiMario.github.io/SEMgraph/reference/Shipley.test.md)
  : Missing edge testing implied by a DAG with Shipley's basis-set
- [`summary(`*`<GGM>`*`)`](https://grassiMario.github.io/SEMgraph/reference/summary.GGM.md)
  : GGM model summary
- [`summary(`*`<RICF>`*`)`](https://grassiMario.github.io/SEMgraph/reference/summary.RICF.md)
  : RICF model summary
- [`transformData()`](https://grassiMario.github.io/SEMgraph/reference/transformData.md)
  : Transform data methods
- [`weightGraph()`](https://grassiMario.github.io/SEMgraph/reference/weightGraph.md)
  : Graph weighting methods

# Articles

### All vignettes

- [Get
  started](https://grassiMario.github.io/SEMgraph/articles/SEMgraph_tutorial.md):
