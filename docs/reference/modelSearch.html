<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal model search strategies — modelSearch • SEMgraph</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal model search strategies — modelSearch"><meta name="description" content="Four model search strategies are implemented combining
SEMdag(), SEMbap(), and resizeGraph() functions.
All strategies estimate a new graph by 1) adjusting (BAP deconfounding) the
the data matrix and 2) re-sizing the output DAG."><meta property="og:description" content="Four model search strategies are implemented combining
SEMdag(), SEMbap(), and resizeGraph() functions.
All strategies estimate a new graph by 1) adjusting (BAP deconfounding) the
the data matrix and 2) re-sizing the output DAG."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SEMgraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/SEMgraph_tutorial.html">Get started</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fernandoPalluzzi/SEMgraph/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal model search strategies</h1>
      <small class="dont-index">Source: <a href="https://github.com/fernandoPalluzzi/SEMgraph/blob/HEAD/R/semLearn.R" class="external-link"><code>R/semLearn.R</code></a></small>
      <div class="d-none name"><code>modelSearch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Four model search strategies are implemented combining
<code><a href="SEMdag.html">SEMdag()</a></code>, <code><a href="SEMbap.html">SEMbap()</a></code>, and <code><a href="resizeGraph.html">resizeGraph()</a></code> functions.
All strategies estimate a new graph by 1) adjusting (BAP deconfounding) the
the data matrix and 2) re-sizing the output DAG.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modelSearch</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  gnet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  search <span class="op">=</span> <span class="st">"basic"</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>Input graph as an igraph object.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></dd>


<dt id="arg-gnet">gnet<a class="anchor" aria-label="anchor" href="#arg-gnet"></a></dt>
<dd><p>Reference directed network used to validate and import
nodes and interactions.</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Maximum allowed geodesic distance for directed or undirected
shortest path search. A distance <code>d = 0</code> disables shortest path
search (fixed in <code>search = "basic"</code>), while <code>d = 1</code>
(fixed in <code>search = "direct"</code>) only search for directed links
(i.e., no mediators are allowed).
A distance <code>d</code> &gt; 1 (defaults to <code>d = 2</code> for "outer" and
"inner" strategies), will search for shortest paths with at most
<code>d</code> - 1 mediators between nodes sharing a significant estimated
interaction.
Connectors are imported from the reference interactome, as specified
by the argument <code>gnet</code>. If the edges of the reference interactome are
weighted by P-value, as defined by the <code>E(gnet)$pv</code> attribute,
the shortest path with the smallest sum of weights will be chosen (e.g.,
see <code><a href="weightGraph.html">weightGraph</a></code> for graph weighting options).</p></dd>


<dt id="arg-search">search<a class="anchor" aria-label="anchor" href="#arg-search"></a></dt>
<dd><p>Search strategy. Four model search strategies are available:</p><ul><li><p>"outer". The estimated DAG is re-sized using
<code><a href="resizeGraph.html">resizeGraph</a></code> to find new indirect paths (i.e.,
inferred directed connections that may hide new mediators). New
interactions and connectors will be searched and imported from the
reference network (argument <code>gnet</code>, see above). Both DAG and
extended graph complexity can be controlled with <code>beta</code> &gt; 0 and
<code>d</code> &gt; 1 arguments, respectively. The term "outer" means that new
model mediator variables are imported from an external resource (i.e.,
the reference network).</p></li>
<li><p>"inner". This strategy is analogous to the "outer" one,
but disables external mediator search. In other words, new indirect
paths are generated by adding new interactions of the input model, so
that mediators will be nodes already present in the input graph. The
reference network is still used to validate new model paths. Also in
this case, <code>beta</code> &gt; 0 and <code>d</code> &gt; 1 are used.</p></li>
<li><p>"direct". The input graph structure is improved through direct
(i.e., adjacent) link search, followed by interaction validation and
import from the reference network, with no mediators (i.e., <code>d = 1</code>).</p></li>
<li><p>"basic" (default). While the previous strategies rely on the
input graph and the reference network to integrate knowledge to the
final model, the "basic" strategy is data-driven. The input graph is
needed to define the topological order. The argument <code>gnet</code> is
set to NULL (i.e., no reference network is needed) and argument
<code>d = 0</code>. Model complexity can be still controlled by setting
<code>beta</code> &gt; 0.</p></li>
</ul></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Numeric value. Minimum absolute LASSO beta coefficient for
a new interaction to be retained in the estimated DAG backbone. Lower
<code>beta</code> values correspond to more complex DAGs.
By default, <code>beta</code> is set to 0 (i.e., maximum complexity).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Multiple testing correction method. One of the values
available in <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>. By default, <code>method</code>
is set to "BH" (i.e., Benjamini-Hochberg multiple test correction).</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level for false discovery rate (FDR) used
for local d-separation tests. This argument is used to
control data de-correlation. A higher <code>alpha</code> level includes more
hidden covariances, thus considering more sources of confounding.
If <code>alpha = 0</code>, data de-correlation is disabled.
By default, <code>alpha = 0.05</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If TRUE, it shows intermediate graphs during the
execution (not recommended for large graphs).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The output model as well as the adjusted dataset are returned
as a list of 2 objects:</p><ul><li><p>"graph", the output model as an igraph object;</p></li>
<li><p>"data", the adjusted dataset.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Search strategies can be ordered by decreasing conservativeness
respect to the input graph, as: "direct", "inner", "outer", and "basic".
The first three strategies are knowledge-based, since they require an
input graph and a reference network, together with data, for
knowledge-assisted model improvement. The last one does not require
any reference and the output model structure will be data-driven.
Output model complexity can be limited using arguments <code>d</code> and
<code>beta</code>.
While d is fixed to 0 or 1 in "basic" or "direct", respectively;
we suggest starting with <code>d = 2</code> (only one mediator)
for the other two strategies.
For knowledge-based strategies, we suggest to to start with
<code>beta = 0</code>. Then, beta can be relaxed (0 to &lt; 0.1) to improve
model fitting, if needed. Since data-driven models can be complex,
we suggest to start from <code>beta = 0</code> when using the "basic" strategy.
The <code>beta</code> value can be relaxed until a good model fit is obtained.
Argument alpha determines the extent of data adjustment: lower alpha
values for FDR correction correspond to a smaller number of significant
confounding factors, hence a weaker correction
(default <code>alpha = 0.05</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Comparison among different model estimation strategies</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nonparanormal(npn) transformation</span></span></span>
<span class="r-in"><span><span class="va">als.npn</span> <span class="op">&lt;-</span> <span class="fu"><a href="transformData.html">transformData</a></span><span class="op">(</span><span class="va">alsData</span><span class="op">$</span><span class="va">exprs</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conducting the nonparanormal transformation via shrunkun ECDF...done.</span>
<span class="r-in"><span><span class="co"># Reference network (KEGG interactome)</span></span></span>
<span class="r-in"><span><span class="va">gnet</span> <span class="op">&lt;-</span> <span class="va">kegg</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Models estimation</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">modelSearch</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span>, gnet <span class="op">=</span> <span class="va">gnet</span>,</span></span>
<span class="r-in"><span>      search <span class="op">=</span> <span class="st">"direct"</span>, beta <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step1: BAP deconfounding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step2: DAG estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step3: DAG resize (remove edges/add nodes)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">modelSearch</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span>, gnet <span class="op">=</span> <span class="va">gnet</span>,</span></span>
<span class="r-in"><span>      d <span class="op">=</span> <span class="fl">2</span>, search <span class="op">=</span> <span class="st">"inner"</span>, beta <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step1: BAP deconfounding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step2: DAG estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step3: DAG resize (remove edges/add nodes)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">modelSearch</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span>, gnet <span class="op">=</span> <span class="va">gnet</span>,</span></span>
<span class="r-in"><span>      d <span class="op">=</span> <span class="fl">2</span>, search <span class="op">=</span> <span class="st">"outer"</span>, beta <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step1: BAP deconfounding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step2: DAG estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step3: DAG resize (remove edges/add nodes)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">modelSearch</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span>, gnet <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>      search <span class="op">=</span> <span class="st">"basic"</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step1: BAP deconfounding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step2: DAG estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step3: DAG resize (remove edges/add nodes)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> None DAG resize for basic search ! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Graphs</span></span></span>
<span class="r-in"><span><span class="co">#old.par &lt;- par(no.readonly = TRUE)</span></span></span>
<span class="r-in"><span><span class="co">#par(mfrow=c(2,2), mar= rep(1,4))</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">graph</span>, main <span class="op">=</span> <span class="st">"direct graph"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modelSearch-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">graph</span>, main <span class="op">=</span> <span class="st">"inner graph"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modelSearch-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">m3</span><span class="op">$</span><span class="va">graph</span>, main <span class="op">=</span> <span class="st">"outer graph"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modelSearch-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">m4</span><span class="op">$</span><span class="va">graph</span>, main <span class="op">=</span> <span class="st">"basic graph"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modelSearch-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#par(old.par)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mario Grassi, Fernando Palluzzi, Barbara Tarantino.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

