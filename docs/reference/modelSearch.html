<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Optimal model search strategies — modelSearch • SEMgraph</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal model search strategies — modelSearch"><meta property="og:description" content="Four model search strategies are implemented combining
SEMdag(), SEMbap(), and resizeGraph() functions.
All strategies estimate a new graph by 1) adjusting (BAP deconfounding) the
the data matrix and 2) re-sizing the output DAG."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMgraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fernandoPalluzzi/SEMgraph/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimal model search strategies</h1>
    <small class="dont-index">Source: <a href="https://github.com/fernandoPalluzzi/SEMgraph/blob/HEAD/R/semLearn.R" class="external-link"><code>R/semLearn.R</code></a></small>
    <div class="hidden name"><code>modelSearch.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Four model search strategies are implemented combining
<code><a href="SEMdag.html">SEMdag()</a></code>, <code><a href="SEMbap.html">SEMbap()</a></code>, and <code><a href="resizeGraph.html">resizeGraph()</a></code> functions.
All strategies estimate a new graph by 1) adjusting (BAP deconfounding) the
the data matrix and 2) re-sizing the output DAG.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modelSearch</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  gnet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  search <span class="op">=</span> <span class="st">"basic"</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>graph</dt>
<dd><p>Input graph as an igraph object.</p></dd>


<dt>data</dt>
<dd><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></dd>


<dt>gnet</dt>
<dd><p>Reference directed network used to validate and import
nodes and interactions.</p></dd>


<dt>d</dt>
<dd><p>Maximum allowed geodesic distance for directed or undirected
shortest path search. A distance <code>d = 0</code> disables shortest path
search (fixed in <code>search = "basic"</code>), while <code>d = 1</code> 
(fixed in <code>search = "direct"</code>) only search for directed links
(i.e., no mediators are allowed).
A distance <code>d</code> &gt; 1 (defaults to <code>d = 2</code> for "outer" and
"inner" strategies), will search for shortest paths with at most
<code>d</code> - 1 mediators between nodes sharing a significant estimated
interaction.
Connectors are imported from the reference interactome, as specified
by the argument <code>gnet</code>. If the edges of the reference interactome are
weighted by P-value, as defined by the <code>E(gnet)$pv</code> attribute,
the shortest path with the smallest sum of weights will be chosen (e.g.,
see <code><a href="weightGraph.html">weightGraph</a></code> for graph weighting options).</p></dd>


<dt>search</dt>
<dd><p>Search strategy. Four model search strategies are available:</p><ul><li><p>"outer". The estimated DAG is re-sized using
<code><a href="resizeGraph.html">resizeGraph</a></code> to find new indirect paths (i.e.,
inferred directed connections that may hide new mediators). New
interactions and connectors will be searched and imported from the
reference network (argument <code>gnet</code>, see above). Both DAG and
extended graph complexity can be controlled with <code>beta</code> &gt; 0 and
<code>d</code> &gt; 1 arguments, respectively. The term "outer" means that new
model mediator variables are imported from an external resource (i.e.,
the reference network).</p></li>
<li><p>"inner". This strategy is analogous to the "outer" one,
but disables external mediator search. In other words, new indirect
paths are generated by adding new interactions of the input model, so
that mediators will be nodes already present in the input graph. The
reference network is still used to validate new model paths. Also in
this case, <code>beta</code> &gt; 0 and <code>d</code> &gt; 1 are used.</p></li>
<li><p>"direct". The input graph structure is improved through direct
(i.e., adjacent) link search, followed by interaction validation and
import from the reference network, with no mediators (i.e., <code>d = 1</code>).</p></li>
<li><p>"basic" (default). While the previous strategies rely on the
input graph and the reference network to integrate knowledge to the
final model, the "basic" strategy is data-driven. The input graph is
needed to define the topological order. The argument <code>gnet</code> is
set to NULL (i.e., no reference network is needed) and argument
<code>d = 0</code>. Model complexity can be still controlled by setting
<code>beta</code> &gt; 0.</p></li>
</ul></dd>


<dt>beta</dt>
<dd><p>Numeric value. Minimum absolute LASSO beta coefficient for
a new interaction to be retained in the estimated DAG backbone. Lower
<code>beta</code> values correspond to more complex DAGs.
By default, <code>beta</code> is set to 0 (i.e., maximum complexity).</p></dd>


<dt>method</dt>
<dd><p>Multiple testing correction method. One of the values
available in <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>. By default, <code>method</code>
is set to "BH" (i.e., Benjamini-Hochberg multiple test correction).</p></dd>


<dt>alpha</dt>
<dd><p>Significance level for false discovery rate (FDR) used
for local d-separation tests. This argument is used to
control data de-correlation. A higher <code>alpha</code> level includes more
hidden covariances, thus considering more sources of confounding.
If <code>alpha = 0</code>, data de-correlation is disabled.
By default, <code>alpha = 0.05</code>.</p></dd>


<dt>verbose</dt>
<dd><p>If TRUE, it shows intermediate graphs during the
execution (not recommended for large graphs).</p></dd>


<dt>...</dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The output model as well as the adjusted dataset are returned
as a list of 2 objects:</p><ul><li><p>"graph", the output model as an igraph object;</p></li>
<li><p>"data", the adjusted dataset.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Search strategies can be ordered by decreasing conservativeness
respect to the input graph, as: "direct", "inner", "outer", and "basic".
The first three strategies are knowledge-based, since they require an
input graph and a reference network, together with data, for
knowledge-assisted model improvement. The last one does not require
any reference and the output model structure will be data-driven.
Output model complexity can be limited using arguments <code>d</code> and
<code>beta</code>.
While d is fixed to 0 or 1 in "basic" or "direct", respectively;
we suggest starting with <code>d = 2</code> (only one mediator)
for the other two strategies.
For knowledge-based strategies, we suggest to to start with
<code>beta = 0</code>. Then, beta can be relaxed (0 to &lt; 0.1) to improve
model fitting, if needed. Since data-driven models can be complex,
we suggest to start from <code>beta = 0</code> when using the "basic" strategy.
The <code>beta</code> value can be relaxed until a good model fit is obtained.
Argument alpha determines the extent of data adjustment: lower alpha
values for FDR correction correspond to a smaller number of significant
confounding factors, hence a weaker correction
(default <code>alpha = 0.05</code>).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparison among different model estimation strategies</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nonparanormal(npn) transformation</span></span></span>
<span class="r-in"><span><span class="va">als.npn</span> <span class="op">&lt;-</span> <span class="fu"><a href="transformData.html">transformData</a></span><span class="op">(</span><span class="va">alsData</span><span class="op">$</span><span class="va">exprs</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conducting the nonparanormal transformation via shrunkun ECDF...done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Models estimation</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">modelSearch</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span>, gnet <span class="op">=</span> <span class="va">kegg</span>,</span></span>
<span class="r-in"><span>      search <span class="op">=</span> <span class="st">"direct"</span>, beta <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step1: BAP deconfounding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step2: DAG estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step3: DAG resize (remove edges/add nodes)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">modelSearch</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span>, gnet <span class="op">=</span> <span class="va">kegg</span>,</span></span>
<span class="r-in"><span>      d <span class="op">=</span> <span class="fl">2</span>, search <span class="op">=</span> <span class="st">"inner"</span>, beta <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step1: BAP deconfounding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step2: DAG estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step3: DAG resize (remove edges/add nodes)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">modelSearch</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span>, gnet <span class="op">=</span> <span class="va">kegg</span>,</span></span>
<span class="r-in"><span>      d <span class="op">=</span> <span class="fl">2</span>, search <span class="op">=</span> <span class="st">"outer"</span>, beta <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step1: BAP deconfounding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step2: DAG estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step3: DAG resize (remove edges/add nodes)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu">modelSearch</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span>, gnet <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>      search <span class="op">=</span> <span class="st">"basic"</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step1: BAP deconfounding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step2: DAG estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Step3: DAG resize (remove edges/add nodes)...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> None DAG resize for basic search ! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Graphs</span></span></span>
<span class="r-in"><span><span class="co">#old.par &lt;- par(no.readonly = TRUE)</span></span></span>
<span class="r-in"><span><span class="co">#par(mfrow=c(2,2), mar= rep(1,4))</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">graph</span>, main <span class="op">=</span> <span class="st">"direct graph"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modelSearch-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">graph</span>, main <span class="op">=</span> <span class="st">"inner graph"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modelSearch-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">m3</span><span class="op">$</span><span class="va">graph</span>, main <span class="op">=</span> <span class="st">"outer graph"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modelSearch-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">m4</span><span class="op">$</span><span class="va">graph</span>, main <span class="op">=</span> <span class="st">"basic graph"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modelSearch-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#par(old.par)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mario Grassi, Fernando Palluzzi, Barbara Tarantino.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

