<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Optimal model search strategies — modelSearch • SEMgraph</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Optimal model search strategies — modelSearch" />
<meta property="og:description" content="Four model search strategies are implemented combining
SEMdag(), SEMbap(), and extendGraph() functions.
All strategies estimate a DAG through the adjusted (de-correlate)
data matrix Z by iteratively update DAG and Z." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMgraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fernandoPalluzzi/SEMgraph/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimal model search strategies</h1>
    <small class="dont-index">Source: <a href='https://github.com/fernandoPalluzzi/SEMgraph/blob/master/R/semUtils.R'><code>R/semUtils.R</code></a></small>
    <div class="hidden name"><code>modelSearch.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Four model search strategies are implemented combining
<code><a href='SEMdag.html'>SEMdag()</a></code>, <code><a href='SEMbap.html'>SEMbap()</a></code>, and <code><a href='extendGraph.html'>extendGraph()</a></code> functions.
All strategies estimate a DAG through the adjusted (de-correlate)
data matrix Z by iteratively update DAG and Z.</p>
    </div>

    <pre class="usage"><span class='fu'>modelSearch</span><span class='op'>(</span>
  <span class='va'>graph</span>,
  <span class='va'>data</span>,
  gnet <span class='op'>=</span> <span class='cn'>NULL</span>,
  d <span class='op'>=</span> <span class='fl'>2</span>,
  search <span class='op'>=</span> <span class='st'>"basic"</span>,
  beta <span class='op'>=</span> <span class='fl'>0</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
  pstop <span class='op'>=</span> <span class='cn'>TRUE</span>,
  limit <span class='op'>=</span> <span class='fl'>30000</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>graph</th>
      <td><p>Input network as an igraph object.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></td>
    </tr>
    <tr>
      <th>gnet</th>
      <td><p>Reference directed network used to validate and import
nodes and interactions.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>Maximum allowed geodesic distance for directed or undirected
shortest path search. A distance <code>d = 0</code> disables shortest path
search (fixed in search = "basic"), while <code>d = 1</code> (fixed in
<code>search = "direct"</code>) only search for directed links (i.e., no
mediators are allowed).
A distance d &gt; 1 (defaults to <code>d = 2</code> for "outer" and "inner"
strategies), will search for shortest paths with at most d - 1 mediators
between nodes sharing a significant estimated interaction.
Connectors are imported from the reference interactome, as specified
by the argument gnet. If the edges of the reference interactome are
weighted by P-value, as defined by the E(graph)$pv attribute, the
shortest path with the smallest sum of weights will be chosen (e.g.,
see <code><a href='weightGraph.html'>weightGraph</a></code> for graph weighting options).</p></td>
    </tr>
    <tr>
      <th>search</th>
      <td><p>Search strategy. Four model search strategies are available:</p><ul>
<li><p>"outer". The estimated DAG is extended using
<code><a href='extendGraph.html'>extendGraph</a></code> to find new indirect paths (i.e.,
inferred directed connections that may hide new mediators). New
interactions and mediators will be searched and imported from the
reference network (argument gnet, see above). Both DAG and extended
graph complexity can be controlled with beta &gt; 0 and d &gt; 1 arguments,
respectively (see below). The term "outer" means that new model mediator
variables are imported from an external resource (i.e., the reference
network).</p></li>
<li><p>"inner". This strategy is analogous to the "outer" one,
but disables external mediator search. In other words, new indirect
paths are generated by adding new interactions of the input model, so
that mediators will be nodes already present in the input graph. The
reference network is still used to validate new model paths. Also in
this case, beta &gt; 0 and d &gt; 1 are used.</p></li>
<li><p>"direct". The input graph structure is improved through direct
(i.e., adjacent) link search, followed by interaction validation and
import from the reference network, with no mediators
(i.e., <code>d = 1</code>).</p></li>
<li><p>"basic" (default). While the previous strategies rely on the
input graph and the reference network to integrate knowledge to the
final model, the "basic" strategy is data-driven. The input graph is
needed to define the topological order. The argument gnet is set
to NULL (i.e., no reference network is needed) and argument <code>d = 0</code>.
Model complexity can be still controlled by setting beta &gt; 0.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>Numeric value. Minimum absolute LASSO beta coefficient for
a new interaction to be retained in the estimated DAG backbone. Lower
beta values correspond to more complex DAGs. By default, beta
is set to 0 (i.e., maximum complexity).</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Significance level for false discovery rate (FDR) used
for either local d-separation tests (below <code>limit</code>) or conditional
independence (CI) test (above <code>limit</code>). This argument is used to
control data de-correlation. A higher <code>alpha</code> level includes more
hidden covariances, thus considering more sources of confounding.
If <code>alpha = 0</code>, data de-correlation is disabled.
By default, <code>alpha = 0.05</code>.</p></td>
    </tr>
    <tr>
      <th>pstop</th>
      <td><p>A logical value. With the argument <code>pstop = TRUE</code>
(default), the algorithm can be halted when the Shipley's global model
test P-value &gt; 0.05. If <code>pstop = FALSE</code>, the model search
algorithm stops when no additional edges can be added to the estimated
DAG.</p></td>
    </tr>
    <tr>
      <th>limit</th>
      <td><p>An integer value corresponding to the number of missing
edges of the extracted acyclic graph. Beyond this limit, multicore
computation is enabled to reduce the computational burden.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If TRUE, it shows intermediate graphs during the
execution (not recommended for large graphs).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The output model as well as the adjusted dataset are returned
as a list of 3 objects:</p><ul>
<li><p>"fit", the fitted output model (lavaan object);</p></li>
<li><p>"graph", the output model as an igraph object;</p></li>
<li><p>"data", the adjusted dataset.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Search strategies can be ordered by decreasing conservativeness
respect to the input graph, as: "direct", "inner", "outer", and "basic".
The first three strategies are knowledge-based, since they require an
input graph and a reference network, together with data, for
knowledge-assisted model improvement. The last one does not require
any reference and the output model structure will be completely
determined by data.
Output model complexity can be limited using arguments d and beta.
While d is fixed to 0 or 1 in <code>"basic"</code> or <code>"direct"</code>,
respectively; we suggest starting with <code>d = 2</code> (only one mediator)
for the other two strategies.
For knowledge-based strategies, we suggest to to start with
<code>beta = 0.1</code>. Then, beta can be relaxed (0 to &lt; 0.1) to improve
model fitting, if needed. Since data-driven models can be complex,
we suggest to start from beta = 0.1 when using the "basic" strategy.
The beta value can be relaxed until a good model fit is obtained.
Argument alpha determines the extent of data adjustment: lower alpha
values for FDR correction correspond to a smaller number of significant
confounding factors, hence a weaker correction (default alpha = 0.05).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Fernando Palluzzi <a href='mailto:fernando.palluzzi@gmail.com'>fernando.palluzzi@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \dontrun{</span>

<span class='co'># Comparison among different model estimation strategies</span>

<span class='co'># Install data examples, reference networks, and pathways</span>
<span class='co'>#devtools::install_github("fernandoPalluzzi/SEMdata")</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>SEMdata</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>huge</span><span class='op'>)</span>

<span class='va'>als.npn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/huge/man/huge.npn.html'>huge.npn</a></span><span class='op'>(</span><span class='va'>alsData</span><span class='op'>$</span><span class='va'>exprs</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Conducting the nonparanormal (npn) transformation via shrunkun ECDF....done.</div><div class='input'>
<span class='co'># Models estimation</span>
<span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'>modelSearch</span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>als.npn</span>, gnet <span class='op'>=</span> <span class='va'>kegg</span>,
      search <span class='op'>=</span> <span class='st'>"direct"</span>, beta <span class='op'>=</span> <span class='fl'>0</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
</div><div class='output co'>#&gt; k = 1 Searching for missing covariances ... 220 
#&gt; d-separation test (basis set) of 417 edges ...
#&gt; #&gt; k = 2 Searching for missing covariances ... 6 
#&gt; d-separation test (basis set) of 417 edges ...
#&gt; #&gt; Done.
#&gt; 
#&gt;     C_test  df   pvalue
#&gt; 1 807.8788 834 0.735657
#&gt; 
#&gt; RICF solver ended normally after 2 iterations 
#&gt; 
#&gt; deviance/df: 1.67821  srmr: 0.0831469 
#&gt; </div><div class='input'><span class='va'>m2</span> <span class='op'>&lt;-</span> <span class='fu'>modelSearch</span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>als.npn</span>, gnet <span class='op'>=</span> <span class='va'>kegg</span>,
      d <span class='op'>=</span> <span class='fl'>2</span>, search <span class='op'>=</span> <span class='st'>"inner"</span>, beta <span class='op'>=</span> <span class='fl'>0.05</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
</div><div class='output co'>#&gt; k = 1 Searching for missing covariances ... 220 
#&gt; d-separation test (basis set) of 288 edges ...
#&gt; #&gt; Done.
#&gt; 
#&gt;     C_test  df   pvalue
#&gt; 1 613.9261 576 0.132785
#&gt; 
#&gt; RICF solver ended normally after 3 iterations 
#&gt; 
#&gt; deviance/df: 1.943444  srmr: 0.0938733 
#&gt; </div><div class='input'><span class='va'>m3</span> <span class='op'>&lt;-</span> <span class='fu'>modelSearch</span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>als.npn</span>, gnet <span class='op'>=</span> <span class='va'>kegg</span>,
      d <span class='op'>=</span> <span class='fl'>2</span>, search <span class='op'>=</span> <span class='st'>"outer"</span>, beta <span class='op'>=</span> <span class='fl'>0.05</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
</div><div class='output co'>#&gt; k = 1 Searching for missing covariances ... 220 
#&gt; d-separation test (basis set) of 288 edges ...
#&gt; #&gt; Done.
#&gt; 
#&gt;     C_test  df   pvalue
#&gt; 1 613.9261 576 0.132785
#&gt; 
#&gt; RICF solver ended normally after 2 iterations 
#&gt; 
#&gt; deviance/df: 1.943452  srmr: 0.0938218 
#&gt; </div><div class='input'><span class='va'>m4</span> <span class='op'>&lt;-</span> <span class='fu'>modelSearch</span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>als.npn</span>, gnet <span class='op'>=</span> <span class='cn'>NULL</span>,
      search <span class='op'>=</span> <span class='st'>"basic"</span>, beta <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
</div><div class='output co'>#&gt; k = 1 Searching for missing covariances ... 220 
#&gt; d-separation test (basis set) of 267 edges ...
#&gt; #&gt; Done.
#&gt; 
#&gt;     C_test  df   pvalue
#&gt; 1 543.7724 534 0.375395
#&gt; 
#&gt; RICF solver ended normally after 2 iterations 
#&gt; 
#&gt; deviance/df: 1.755445  srmr: 0.0839307 
#&gt; </div><div class='input'>
<span class='co'># Graphs</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span>, mar<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='gplot.html'>gplot</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>$</span><span class='va'>graph</span>, main <span class='op'>=</span> <span class='st'>"direct graph"</span><span class='op'>)</span>
<span class='fu'><a href='gplot.html'>gplot</a></span><span class='op'>(</span><span class='va'>m2</span><span class='op'>$</span><span class='va'>graph</span>, main <span class='op'>=</span> <span class='st'>"inner graph"</span><span class='op'>)</span>
<span class='fu'><a href='gplot.html'>gplot</a></span><span class='op'>(</span><span class='va'>m3</span><span class='op'>$</span><span class='va'>graph</span>, main <span class='op'>=</span> <span class='st'>"outer graph"</span><span class='op'>)</span>
<span class='fu'><a href='gplot.html'>gplot</a></span><span class='op'>(</span><span class='va'>m4</span><span class='op'>$</span><span class='va'>graph</span>, main <span class='op'>=</span> <span class='st'>"basic graph"</span><span class='op'>)</span>
</div><div class='img'><img src='modelSearch-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mario Grassi, Fernando Palluzzi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


