<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>SEM-based differential connectivity inference (DCI) — SEMdci • SEMgraph</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="SEM-based differential connectivity inference (DCI) — SEMdci"><meta property="og:description" content="Creates a network with perturbed edges obtained from 
the output of SEMrun with two-group and CGGM solver.
To increase the efficiency of computations for large graphs,
users can select to break the network structure into clusters and select
the topological clustering method (see clusterGraph). 
The function SEMrun is applied iteratively on 
each cluster to obtain the graph with the full list of perturbed edges."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMgraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fernandoPalluzzi/SEMgraph/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SEM-based differential connectivity inference (DCI)</h1>
    <small class="dont-index">Source: <a href="https://github.com/fernandoPalluzzi/SEMgraph/blob/HEAD/R/semUtils.R" class="external-link"><code>R/semUtils.R</code></a></small>
    <div class="hidden name"><code>SEMdci.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a network with perturbed edges obtained from 
the output of <code><a href="SEMrun.html">SEMrun</a></code> with two-group and CGGM solver.
To increase the efficiency of computations for large graphs,
users can select to break the network structure into clusters and select
the topological clustering method (see <code><a href="clusterGraph.html">clusterGraph</a></code>). 
The function <code><a href="SEMrun.html">SEMrun</a></code> is applied iteratively on 
each cluster to obtain the graph with the full list of perturbed edges.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">SEMdci</span><span class="op">(</span><span class="va">graph</span>, <span class="va">data</span>, <span class="va">group</span>, C <span class="op">=</span> <span class="st">"none"</span>, method <span class="op">=</span> <span class="st">"BH"</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>graph</dt>
<dd><p>Input network as an igraph object.</p></dd>
<dt>data</dt>
<dd><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></dd>
<dt>group</dt>
<dd><p>A binary vector. This vector must be as long as the number
of subjects. Each vector element must be 1 for cases and 0 for control
subjects.</p></dd>
<dt>C</dt>
<dd><p>Topological clustering methods (default C = "none"). If
<code>type = "tahc"</code>, network modules are generated using the tree
agglomerative hierarchical clustering method (Yu et al., 2015).
Other non-tree clustering methods from igraph package include: "wtc"
(walktrap community structure with short random walks),
"ebc" (edge betweeness clustering), "fgc" (fast greedy method), "lbc"
(label propagation method), "lec" (leading eigenvector method), "loc"
(multi-level optimization), "opc" (optimal community structure), "sgc"
(spinglass statistical mechanics).</p></dd>
<dt>method</dt>
<dd><p>Multiple testing correction method. One of the values
available in <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>. By default, method is set
to "BH" (i.e., Benjamini-Hochberg correction).</p></dd>
<dt>alpha</dt>
<dd><p>Gene set test significance level (default = 0.05).</p></dd>
<dt>...</dt>
<dd><p>Currently ignored.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An igraph object.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># \dontrun{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Nonparanormal(npn) transformation</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">huge</span><span class="op">)</span></span>
<span class="r-in"><span class="va">als.npn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/huge/man/huge.npn.html" class="external-link">huge.npn</a></span><span class="op">(</span><span class="va">alsData</span><span class="op">$</span><span class="va">exprs</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conducting the nonparanormal (npn) transformation via shrunkun ECDF....done.</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">kegg.pathways</span><span class="op">[[</span><span class="st">"MAPK signaling pathway"</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="properties.html">properties</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>; <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Frequency distribution of graph components</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n.nodes n.graphs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       3        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     291        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent of vertices in the giant component: 99 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   is.simple      is.dag is.directed is.weighted </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        TRUE       FALSE        TRUE        TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> which.mutual.FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               1967 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IGRAPH 9c9bb66 DNW- 291 1967 -- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + attr: name (v/c), weight (e/n)</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Create ALS network with perturbed edges using edge betweeness clustering</span></span>
<span class="r-in"><span class="va">gU</span><span class="op">&lt;-</span> <span class="fu">SEMdci</span><span class="op">(</span><span class="va">G</span>, <span class="va">als.npn</span>, <span class="va">alsData</span><span class="op">$</span><span class="va">group</span>, C<span class="op">=</span><span class="st">"ebc"</span>, method<span class="op">=</span><span class="st">"BH"</span>, alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> modularity = 0.5407795 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Community sizes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4   3   6   1   5   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8  12  17  74  75 105 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit cluster = 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit cluster = 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit cluster = 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit cluster = 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit cluster = 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-in"><span class="va">gcU</span><span class="op">&lt;-</span> <span class="fu"><a href="properties.html">properties</a></span><span class="op">(</span><span class="va">gU</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Frequency distribution of graph components</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n.nodes n.graphs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       2        4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       3        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       4        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      30        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      44        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      64        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percent of vertices in the giant component: 41 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   is.simple      is.dag is.directed is.weighted </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        TRUE        TRUE        TRUE       FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> which.mutual.FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 81 </span>
<span class="r-in"></span>
<span class="r-in"><span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">gcU</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, l<span class="op">=</span><span class="st">"fdp"</span><span class="op">)</span> <span class="co"># max component</span></span>
<span class="r-in"><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">gcU</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, l<span class="op">=</span><span class="st">"fdp"</span><span class="op">)</span> <span class="co"># 2nd cpmponent</span></span>
<span class="r-in"><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">gcU</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, l<span class="op">=</span><span class="st">"fdp"</span><span class="op">)</span> <span class="co"># 3rd component </span></span>
<span class="r-in"><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">gcU</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, l<span class="op">=</span><span class="st">"fdp"</span><span class="op">)</span> <span class="co"># 4th component</span></span>
<span class="r-plt img"><img src="SEMdci-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mario Grassi, Fernando Palluzzi, Barbara Tarantino.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

