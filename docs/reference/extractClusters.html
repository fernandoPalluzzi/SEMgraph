<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cluster extraction utility — extractClusters • SEMgraph</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cluster extraction utility — extractClusters"><meta name="description" content="Extract and fit clusters from an input graph."><meta property="og:description" content="Extract and fit clusters from an input graph."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SEMgraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/SEMgraph_tutorial.html">Get started</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fernandoPalluzzi/SEMgraph/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cluster extraction utility</h1>
      <small class="dont-index">Source: <a href="https://github.com/fernandoPalluzzi/SEMgraph/blob/HEAD/R/semCluster.R" class="external-link"><code>R/semCluster.R</code></a></small>
      <div class="d-none name"><code>extractClusters.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract and fit clusters from an input graph.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extractClusters</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  membership <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  map <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>Input network as an igraph object.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>A binary vector. This vector must be as long as the
number of subjects. Each vector element must be 1 for cases and 0
for control subjects. Group specification enables node perturbation
testing. By default, <code>group = NULL</code>.</p></dd>


<dt id="arg-membership">membership<a class="anchor" aria-label="anchor" href="#arg-membership"></a></dt>
<dd><p>A vector of cluster membership IDs. If NULL, clusters
will be automatically generated with <code><a href="clusterGraph.html">clusterGraph</a></code>
using the edge betweenness clustering ("ebc") algorithm.</p></dd>


<dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>Logical value. If TRUE, the plot of the input graph
(coloured by cluster membership) will be generated along with independent
module plots. If the input graph is very large, plotting could be
computationally intensive (by default, <code>map = FALSE</code>).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical value. If TRUE, a plot will be showed for each
cluster.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of 3 objects:</p><ol><li><p>"clusters", list of clusters as igraph objects;</p></li>
<li><p>"fit", list of fitting results for each cluster as a lavaan object;</p></li>
<li><p>"dfc", data.frame of summary results.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Fernando Palluzzi <a href="mailto:fernando.palluzzi@gmail.com">fernando.palluzzi@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Nonparanormal(npn) transformation</span></span></span>
<span class="r-in"><span><span class="va">als.npn</span> <span class="op">&lt;-</span> <span class="fu"><a href="transformData.html">transformData</a></span><span class="op">(</span><span class="va">alsData</span><span class="op">$</span><span class="va">exprs</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conducting the nonparanormal transformation via shrunkun ECDF...done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adjdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="SEMbap.html">SEMbap</a></span><span class="op">(</span><span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, <span class="va">als.npn</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bow-free covariances search. Use method: cggm ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of bow-free covariances / df : 220 / 420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max parent set(S) / Sparsity idx(s) : 10 / 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of clusters / number of nodes: 2 / 31 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clusters creation</span></span></span>
<span class="r-in"><span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu">extractClusters</span><span class="op">(</span><span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, <span class="va">adjdata</span>, <span class="va">alsData</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> modularity = 0.5588502 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Community sizes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3  2  1  4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4  8  9 11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  cluster= 1 of 3 cluster= 2 of 3 cluster= 3 of 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Found 3 clusters with &gt; 5 nodes</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">dfc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cluster n.nodes n.edges dev_df  srmr V.pv.act V.pv.inh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     HM1       9       8  1.062 0.052 0.000118 0.058611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     HM2       8       7  1.180 0.059 0.000468 0.927939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     HM4      11      25  1.840 0.059 0.000002 0.007126</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">HM1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lhs op   rhs    est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  6647  ~ group -0.156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 10452  ~ group -0.021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 84134  ~ group -0.080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 79139  ~ group  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  5530  ~ group -0.134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  5532  ~ group  0.169</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">HM2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lhs op   rhs    est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 54205  ~ group  0.056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   836  ~ group  0.200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   581  ~ group -0.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   572  ~ group -0.045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   596  ~ group  0.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   598  ~ group  0.198</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">HM4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lhs op   rhs    est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 4217  ~ group  0.086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 5606  ~ group  0.033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 5608  ~ group  0.188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1432  ~ group -0.017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 5600  ~ group -0.296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 5603  ~ group  0.003</span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">$</span><span class="va">clusters</span><span class="op">$</span><span class="va">HM2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="extractClusters-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Map cluster on the input graph</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span></span></span>
<span class="r-in"><span><span class="va">c</span> <span class="op">&lt;-</span> <span class="va">clusters</span><span class="op">$</span><span class="va">clusters</span><span class="op">$</span><span class="va">HM2</span></span></span>
<span class="r-in"><span><span class="fu">V</span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu">V</span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">V</span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">$</span><span class="va">name</span>, <span class="st">"gold"</span>, <span class="st">"white"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="extractClusters-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mario Grassi, Fernando Palluzzi, Barbara Tarantino.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

