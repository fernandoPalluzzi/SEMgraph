<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cluster extraction utility — extractClusters • SEMgraph</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Cluster extraction utility — extractClusters" />
<meta property="og:description" content="Extract and fit clusters from an input graph." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMgraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fernandoPalluzzi/SEMgraph/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Cluster extraction utility</h1>
    <small class="dont-index">Source: <a href='https://github.com/fernandoPalluzzi/SEMgraph/blob/master/R/semUtils.R'><code>R/semUtils.R</code></a></small>
    <div class="hidden name"><code>extractClusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract and fit clusters from an input graph.</p>
    </div>

    <pre class="usage"><span class='fu'>extractClusters</span><span class='op'>(</span>
  <span class='va'>graph</span>,
  <span class='va'>data</span>,
  group <span class='op'>=</span> <span class='cn'>NULL</span>,
  membership <span class='op'>=</span> <span class='cn'>NULL</span>,
  map <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>graph</th>
      <td><p>Input network as an igraph object.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A binary vector. This vector must be as long as the
number of subjects. Each vector element must be 1 for cases and 0
for control subjects. Group specification enables node perturbation
testing. By default, <code>group = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>membership</th>
      <td><p>A vector of cluster membership IDs. If NULL, clusters
will be automatically generated with <code><a href='clusterGraph.html'>clusterGraph</a></code>
using the edge betweenness clustering ("ebc") algorithm.</p></td>
    </tr>
    <tr>
      <th>map</th>
      <td><p>Logical value. If TRUE, the plot of the input graph
(coloured by cluster membership) will be generated along with independent
module plots. If the input graph is very large, plotting could be
computationally intensive (by default, <code>map = FALSE</code>).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical value. If TRUE, a plot will be showed for each
cluster.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List of clusters as igraph objects and fitting results for
each cluster as a lavaan object.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Fernando Palluzzi <a href='mailto:fernando.palluzzi@gmail.com'>fernando.palluzzi@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \dontrun{</span>

<span class='co'># Install data examples, reference networks, and pathways</span>
<span class='co'>#devtools::install_github("fernandoPalluzzi/SEMdata")</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>SEMdata</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>huge</span><span class='op'>)</span>

<span class='va'>als.npn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/huge/man/huge.npn.html'>huge.npn</a></span><span class='op'>(</span><span class='va'>alsData</span><span class='op'>$</span><span class='va'>exprs</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Conducting the nonparanormal (npn) transformation via shrunkun ECDF....done.</div><div class='input'>
<span class='va'>adjdata</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SEMbap.html'>SEMbap</a></span><span class='op'>(</span><span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, <span class='va'>als.npn</span><span class='op'>)</span><span class='op'>$</span><span class='va'>data</span>
</div><div class='output co'>#&gt; d-separation test (basis set) of 420 edges ...
#&gt; #&gt; Number of significant local tests: 220 / 420 
#&gt; </div><div class='input'>
<span class='co'># Clusters creation</span>
<span class='va'>clusters</span> <span class='op'>&lt;-</span> <span class='fu'>extractClusters</span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>adjdata</span><span class='op'>)</span>
</div><div class='output co'>#&gt; modularity = 0.5588502 
#&gt; 
#&gt; Community sizes
#&gt;  3  2  1  4 
#&gt;  4  8  9 11 
#&gt; 
#&gt;   cluster N.nodes N.edges dev_df  srmr pv.act pv.inh
#&gt; 1     HM1       9       8  1.086 0.061      1      1
#&gt; 2     HM2       8       7  0.826 0.039      1      1
#&gt; 3     HM4      11      25  1.693 0.061      1      1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>parameterEstimates</span><span class='op'>(</span><span class='va'>clusters</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>HM1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      lhs op   rhs    est    se      z pvalue ci.lower ci.upper
#&gt; 1 z10452  ~ z6647 -0.044 0.079 -0.553  0.580   -0.198    0.111
#&gt; 2  z5530  ~ z6647 -0.066 0.079 -0.833  0.405   -0.220    0.089
#&gt; 3  z5532  ~ z6647 -0.017 0.079 -0.218  0.827   -0.172    0.138
#&gt; 4  z5533  ~ z6647 -0.179 0.078 -2.302  0.021   -0.332   -0.027
#&gt; 5  z5534  ~ z6647 -0.066 0.079 -0.838  0.402   -0.221    0.089
#&gt; 6  z5535  ~ z6647 -0.430 0.071 -6.019  0.000   -0.570   -0.290</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>parameterEstimates</span><span class='op'>(</span><span class='va'>clusters</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>HM2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      lhs op  rhs    est    se      z pvalue ci.lower ci.upper
#&gt; 1 z54205  ~ z572 -0.140 0.071 -1.962  0.050   -0.280    0.000
#&gt; 2 z54205  ~ z581 -0.247 0.071 -3.463  0.001   -0.387   -0.107
#&gt; 3 z54205  ~ z596  0.119 0.073  1.634  0.102   -0.024    0.261
#&gt; 4 z54205  ~ z598 -0.315 0.073 -4.338  0.000   -0.457   -0.173
#&gt; 5   z836  ~ z842  0.049 0.079  0.620  0.536   -0.106    0.204
#&gt; 6   z842  ~ z317  0.063 0.079  0.798  0.425   -0.092    0.218</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>parameterEstimates</span><span class='op'>(</span><span class='va'>clusters</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>HM4</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     lhs op   rhs    est    se      z pvalue ci.lower ci.upper
#&gt; 1 z1432  ~ z5606  0.440 0.070  6.257  0.000    0.302    0.578
#&gt; 2 z1432  ~ z5608 -0.110 0.070 -1.560  0.119   -0.248    0.028
#&gt; 3 z4741  ~ z1432  0.106 0.078  1.355  0.175   -0.047    0.258
#&gt; 4 z4741  ~ z5600 -0.115 0.076 -1.509  0.131   -0.264    0.034
#&gt; 5 z4741  ~ z5603  0.140 0.076  1.840  0.066   -0.009    0.289
#&gt; 6 z4741  ~ z5630  0.002 0.076  0.028  0.978   -0.147    0.152</div><div class='input'><span class='fu'><a href='gplot.html'>gplot</a></span><span class='op'>(</span><span class='va'>clusters</span><span class='op'>$</span><span class='va'>clusters</span><span class='op'>$</span><span class='va'>HM2</span><span class='op'>)</span>
</div><div class='img'><img src='extractClusters-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Map cluster on the input graph</span>
<span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>
<span class='va'>c</span> <span class='op'>&lt;-</span> <span class='va'>clusters</span><span class='op'>$</span><span class='va'>clusters</span><span class='op'>$</span><span class='va'>HM2</span>
<span class='fu'>V</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'>V</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span> <span class='op'>%in%</span> <span class='fu'>V</span><span class='op'>(</span><span class='va'>c</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, <span class='st'>"gold"</span>, <span class='st'>"white"</span><span class='op'>)</span>
<span class='fu'><a href='gplot.html'>gplot</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>
</div><div class='img'><img src='extractClusters-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mario Grassi, Fernando Palluzzi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


