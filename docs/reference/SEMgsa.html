<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>SEM-based gene set analysis — SEMgsa • SEMgraph</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="SEM-based gene set analysis — SEMgsa"><meta property="og:description" content="Gene Set Analysis (GSA) via self-contained test for group
effect on signaling (directed) pathways based on SEM. The core of the
methodology is implemented in the RICF algorithm of SEMrun(),
recovering from RICF output node-specific group effect p-values, and
Brown’s combined permutation p-values of node activation and inhibition."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMgraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fernandoPalluzzi/SEMgraph/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SEM-based gene set analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/fernandoPalluzzi/SEMgraph/blob/HEAD/R/semUtils.R" class="external-link"><code>R/semUtils.R</code></a></small>
    <div class="hidden name"><code>SEMgsa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Gene Set Analysis (GSA) via self-contained test for group
effect on signaling (directed) pathways based on SEM. The core of the
methodology is implemented in the RICF algorithm of <code><a href="SEMrun.html">SEMrun()</a></code>,
recovering from RICF output node-specific group effect p-values, and
Brown’s combined permutation p-values of node activation and inhibition.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SEMgsa</span><span class="op">(</span>g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">data</span>, <span class="va">group</span>, method <span class="op">=</span> <span class="st">"BH"</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, n_rep <span class="op">=</span> <span class="fl">1000</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>g</dt>
<dd><p>A list of pathways to be tested.</p></dd>


<dt>data</dt>
<dd><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></dd>


<dt>group</dt>
<dd><p>A binary vector. This vector must be as long as the number
of subjects. Each vector element must be 1 for cases and 0 for control
subjects.</p></dd>


<dt>method</dt>
<dd><p>Multiple testing correction method. One of the values
available in <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>. By default, method is set
to "BH" (i.e., Benjamini-Hochberg correction).</p></dd>


<dt>alpha</dt>
<dd><p>Gene set test significance level (default = 0.05).</p></dd>


<dt>n_rep</dt>
<dd><p>Number of randomization replicates (default = 1000).</p></dd>


<dt>...</dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of 2 objects:</p><ol><li><p>"gsa", A data.frame reporting the following information for each
pathway in the input list:</p><ul><li><p>"No.nodes", pathway size (number of nodes);</p></li>
<li><p>"No.DEGs", number of differential espression genes (DEGs) within
the pathway, after multiple test correction with one of the methods
available in <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>;</p></li>
<li><p>"pert", pathway perturbation status (see details);</p></li>
<li><p>"pNA", Brown's combined P-value of pathway node activation;</p></li>
<li><p>"pNI", Brown's combined P-value of pathway node inhibition;</p></li>
<li><p>"PVAL", Bonferroni combined P-value of pNA, and pNI; i.e.,
2* min(pNA, PNI);</p></li>
<li><p>"ADJP", Adjusted Bonferroni P-value of pathway perturbation; i.e.,
min(No.pathways * PVAL; 1).</p></li>
</ul></li>
<li><p>"DEG", a list with DEGs names per pathways.</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>For gaining more biological insights into the functional roles
of pre-defined subsets of genes, node perturbation obtained from RICF
fitting has been combined with up- or down-regulation of genes from KEGG
to obtain overall pathway perturbation as follows:</p><ul><li><p>The node perturbation is defined as activated when the minimum among
the p-values is positive; if negative, the status is inhibited.</p></li>
<li><p>Up- or down- regulation of genes (derived from KEGG database) has
been obtained from the weighted adjacency matrix of each pathway as column
sum of weights over each source node. If the overall sum of node weights
is below 1, the pathway is flagged as down-regulated otherwise as up-regulated.</p></li>
<li><p>The combination between these two quantities allows to define the
direction (up or down) of gene perturbation. Up- or down regulated gene status,
associated with node inhibition, indicates a decrease in activation (or
increase in inhibition) in cases with respect to control group. Conversely,
up- or down regulated gene status, associated with node activation, indicates
an increase in activation (or decrease in inhibition) in cases with
respect to control group.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Grassi, M., Tarantino, B. SEMgsa: topology-based pathway enrichment analysis with
structural equation models. BMC Bioinformatics 23, 344 (2022).
https://doi.org/10.1186/s12859-022-04884-8</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Mario Grassi <a href="mailto:mario.grassi@unipv.it">mario.grassi@unipv.it</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nonparanormal(npn) transformation</span></span></span>
<span class="r-in"><span><span class="va">als.npn</span> <span class="op">&lt;-</span> <span class="fu"><a href="transformData.html">transformData</a></span><span class="op">(</span><span class="va">alsData</span><span class="op">$</span><span class="va">exprs</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conducting the nonparanormal transformation via shrunkun ECDF...done.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Selection of FTD-ALS pathways from kegg.pathways.Rdata</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">paths.name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MAPK signaling pathway"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Protein processing in endoplasmic reticulum"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Endocytosis"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Wnt signaling pathway"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Neurotrophin signaling pathway"</span>,</span></span>
<span class="r-in"><span>                <span class="st">"Amyotrophic lateral sclerosis"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kegg.pathways</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">paths.name</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">GSA</span> <span class="op">&lt;-</span> <span class="fu">SEMgsa</span><span class="op">(</span><span class="va">kegg.pathways</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">als.npn</span>, <span class="va">alsData</span><span class="op">$</span><span class="va">group</span>,</span></span>
<span class="r-in"><span>              method <span class="op">=</span> <span class="st">"bonferroni"</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>              n_rep <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k = 1 Protein processing in endoplasmic reticulum </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k = 2 MAPK signaling pathway </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k = 3 Wnt signaling pathway </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k = 4 Endocytosis </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k = 5 Neurotrophin signaling pathway </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k = 6 Amyotrophic lateral sclerosis </span>
<span class="r-in"><span><span class="va">GSA</span><span class="op">$</span><span class="va">gsa</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                             No.nodes No.DEGs     pert</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neurotrophin signaling pathway                   119      17   up act</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Protein processing in endoplasmic reticulum      170       9 down act</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wnt signaling pathway                            174       8 down inh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MAPK signaling pathway                           301      47   up act</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Amyotrophic lateral sclerosis                    364       9 down inh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Endocytosis                                      250       2     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                      pNa          pNi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neurotrophin signaling pathway              2.353673e-14 9.359608e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Protein processing in endoplasmic reticulum 4.187547e-09 1.130873e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wnt signaling pathway                       4.591216e-12 2.752644e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MAPK signaling pathway                      6.054046e-12 4.914468e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Amyotrophic lateral sclerosis               8.383960e-12 1.452882e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Endocytosis                                 1.564526e-01 3.142695e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                     PVAL         ADJP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neurotrophin signaling pathway              4.707346e-14 2.824407e-13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Protein processing in endoplasmic reticulum 2.261746e-12 1.357048e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wnt signaling pathway                       9.182433e-12 5.509460e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MAPK signaling pathway                      1.210809e-11 7.264855e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Amyotrophic lateral sclerosis               1.676792e-11 1.006075e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Endocytosis                                 6.285389e-04 3.771234e-03</span>
<span class="r-in"><span><span class="va">GSA</span><span class="op">$</span><span class="va">DEG</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Neurotrophin signaling pathway`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "207"  "208"  "1398" "1399" "3551" "3845" "4215" "4217" "5602" "5600"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "5599" "5601" "4893" "5879" "5906" "9252" "6654"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Protein processing in endoplasmic reticulum`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1649"  "5602"  "5599"  "5601"  "578"   "2081"  "4780"  "23645" "7466" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Wnt signaling pathway`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "6885" "4772" "4775" "5532" "5534" "5567" "5879" "5881"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`MAPK signaling pathway`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "207"       "208"       "774"       "775"       "776"       "9254"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "836"       "1398"      "1436"      "1946"      "8822"      "2885"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "3480"      "8517"      "8681"      "4254"      "4296"      "7786"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "4215"      "9064"      "8491"      "1432"      "5599"      "23162"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "5601"      "2122"      "8569"      "4763"      "4772"      "4775"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "56034"     "5228"      "100137049" "5494"      "5532"      "5534"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "5567"      "84867"     "5879"      "5881"      "5906"      "5921"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] "5922"      "9252"      "6654"      "23118"     "57551"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Amyotrophic lateral sclerosis`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "836"  "5608" "5600" "4747" "4741" "5532" "5534" "5879" "2081"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Endocytosis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2261" "2264"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mario Grassi, Fernando Palluzzi, Barbara Tarantino.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

