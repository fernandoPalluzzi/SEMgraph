<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>SEM-based gene set analysis — SEMgsa • SEMgraph</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="SEM-based gene set analysis — SEMgsa" />
<meta property="og:description" content="Gene Set Analysis (GSA) via self-contained test for group
effect on signaling (directed) pathways as SEM, evaluating overall pathway
perturbation, perturbation emission from source nodes, and perturbation
accumulation on target nodes. Approximate randomization test P-values
of specific node and aggregated group effects will be computed.
For directed graphs, they include: the sum of group effects adjusted
by residual variances (D), the sum of the tagret nodes perturbation
(i.e., group effect) accumulation from source nodes (A), and the sum
of the source nodes perturbation emission towards target nodes (E).
For undirected graphs, the sum of group effects, adjusted
by residual variances (D), will be estimated." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMgraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fernandoPalluzzi/SEMgraph/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SEM-based gene set analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/fernandoPalluzzi/SEMgraph/blob/master/R/semUtils.R'><code>R/semUtils.R</code></a></small>
    <div class="hidden name"><code>SEMgsa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Gene Set Analysis (GSA) via self-contained test for group
effect on signaling (directed) pathways as SEM, evaluating overall pathway
perturbation, perturbation emission from source nodes, and perturbation
accumulation on target nodes. Approximate randomization test P-values
of specific node and aggregated group effects will be computed.
For directed graphs, they include: the sum of group effects adjusted
by residual variances (D), the sum of the tagret nodes perturbation
(i.e., group effect) accumulation from source nodes (A), and the sum
of the source nodes perturbation emission towards target nodes (E).
For undirected graphs, the sum of group effects, adjusted
by residual variances (D), will be estimated.</p>
    </div>

    <pre class="usage"><span class='fu'>SEMgsa</span><span class='op'>(</span>g <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>data</span>, <span class='va'>group</span>, method <span class='op'>=</span> <span class='st'>"BH"</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span>, n_rep <span class='op'>=</span> <span class='fl'>1000</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>g</th>
      <td><p>A list of pathways to be tested.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A binary vector. This vector must be as long as the number
of subjects. Each vector element must be 1 for cases and 0 for control
subjects.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Multiple testing correction method. One of the values
available in <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code>. By default, method is set
to "BH" (i.e., Benjamini-Hochberg correction).</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Gene set test significance level. Alpha is set to 0.05
by default.</p></td>
    </tr>
    <tr>
      <th>n_rep</th>
      <td><p>Number of randomization replicates (default = 1000).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of 2 objects:</p><ol>
<li><p>"gsa", A data.frame reporting the following information for each
pathway in the input list:</p><ul>
<li><p>"N.nodes", pathway size (number of nodes);</p></li>
<li><p>"N.DRNs", number of differential regulated genes (DRNs) within the pathway,
after multiple test correction with Benjamini-Hochberg method;</p></li>
<li><p>"pD", significance of the sum of group effects, adjusted by the
residual variance;</p></li>
<li><p>"pA", significance of the sum of tagret nodes perturbation
(i.e., group effect) accumulation from source nodes;</p></li>
<li><p>"pE", significance of the sum of source nodes perturbation
(i.e., group effect) emission towards target nodes;</p></li>
<li><p>"pvalue", Fisher's combined P-value of pD, pA, and pE.</p></li>
</ul></li>
<li><p>"DRN", a list with DRNs names per pathways.</p></li>
</ol>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Mario Grassi <a href='mailto:mario.grassi@unipv.it'>mario.grassi@unipv.it</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \dontrun{</span>

<span class='co'># Install data examples, reference networks, and pathways</span>
<span class='co'>#devtools::install_github("fernandoPalluzzi/SEMdata")</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>SEMdata</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'SEMdata'</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:SEMgraph':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    alsData, kegg</span></div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>huge</span><span class='op'>)</span>

<span class='va'>als.npn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/huge/man/huge.npn.html'>huge.npn</a></span><span class='op'>(</span><span class='va'>alsData</span><span class='op'>$</span><span class='va'>exprs</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Conducting the nonparanormal (npn) transformation via shrunkun ECDF....done.</div><div class='input'>
<span class='co'>#selection of FTD pathways from KEGG site:</span>
<span class='co'># https://www.genome.jp/dbget-bin/www_bget?ds:H00078</span>

<span class='va'>paths.name</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
 <span class='st'>"MAPK signaling pathway"</span>,
 <span class='st'>"Protein processing in endoplasmic reticulum"</span>,
 <span class='st'>"Endocytosis"</span>,
 <span class='st'>"Wnt signaling pathway"</span>,
 <span class='st'>"Notch signaling pathway"</span>,
 <span class='st'>"Neurotrophin signaling pathway"</span>,
 <span class='st'>"Amyotrophic lateral sclerosis (ALS)"</span><span class='op'>)</span>

<span class='va'>I</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>kegg.pathways</span><span class='op'>)</span> <span class='op'>%in%</span> <span class='va'>paths.name</span><span class='op'>)</span>
<span class='va'>GSA</span> <span class='op'>&lt;-</span> <span class='fu'>SEMgsa</span><span class='op'>(</span><span class='va'>kegg.pathways</span><span class='op'>[</span><span class='va'>I</span><span class='op'>]</span>, <span class='va'>als.npn</span>, <span class='va'>alsData</span><span class='op'>$</span><span class='va'>group</span>,
              method <span class='op'>=</span> <span class='st'>"bonferroni"</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
              n_rep <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>
</div><div class='output co'>#&gt; # 1: MAPK signaling pathway
#&gt; # 2: Protein processing in endoplasmic reticulum
#&gt; # 3: Endocytosis
#&gt; # 4: Wnt signaling pathway
#&gt; # 5: Notch signaling pathway
#&gt; # 6: Neurotrophin signaling pathway
#&gt; # 7: Amyotrophic lateral sclerosis (ALS)</div><div class='input'><span class='va'>GSA</span><span class='op'>$</span><span class='va'>gsa</span>
</div><div class='output co'>#&gt;                                             N.nodes N.DRNs       pD       pA
#&gt; MAPK signaling pathway                          292     47 0.915807 0.010656
#&gt; Protein processing in endoplasmic reticulum      26     10 0.877232 0.000002
#&gt; Endocytosis                                      29      7 0.000001 0.000003
#&gt; Wnt signaling pathway                           157     33 0.017545 0.923278
#&gt; Notch signaling pathway                          53     14 0.000049 0.000429
#&gt; Neurotrophin signaling pathway                  117     32 0.003745 0.006109
#&gt; Amyotrophic lateral sclerosis (ALS)              32      7 0.013752 0.000541
#&gt;                                                   pE   pvalue
#&gt; MAPK signaling pathway                      0.410353 0.087129
#&gt; Protein processing in endoplasmic reticulum 0.052767 0.000014
#&gt; Endocytosis                                 0.478188 0.000000
#&gt; Wnt signaling pathway                       0.774848 0.187785
#&gt; Notch signaling pathway                     0.000000 0.000000
#&gt; Neurotrophin signaling pathway              0.208317 0.000421
#&gt; Amyotrophic lateral sclerosis (ALS)         0.287008 0.000212</div><div class='input'><span class='va'>GSA</span><span class='op'>$</span><span class='va'>DRN</span>
</div><div class='output co'>#&gt; $`MAPK signaling pathway`
#&gt;  [1] "207"       "208"       "774"       "775"       "776"       "9254"     
#&gt;  [7] "836"       "1398"      "1436"      "1946"      "8822"      "2885"     
#&gt; [13] "3480"      "8517"      "8681"      "4254"      "4296"      "7786"     
#&gt; [19] "4215"      "9064"      "8491"      "1432"      "5599"      "23162"    
#&gt; [25] "5601"      "2122"      "8569"      "4763"      "4772"      "4775"     
#&gt; [31] "56034"     "5228"      "100137049" "5494"      "5532"      "5534"     
#&gt; [37] "5567"      "84867"     "5879"      "5881"      "5906"      "5921"     
#&gt; [43] "5922"      "9252"      "6654"      "23118"     "57551"    
#&gt; 
#&gt; $`Protein processing in endoplasmic reticulum`
#&gt;  [1] "578"   "1649"  "27102" "2081"  "5602"  "5599"  "5601"  "4780"  "23645"
#&gt; [10] "7466" 
#&gt; 
#&gt; $Endocytosis
#&gt; [1] "867"   "2060"  "83737" "4193"  "51100" "56904" "11059"
#&gt; 
#&gt; $`Wnt signaling pathway`
#&gt;  [1] "10297" "816"   "894"   "896"   "57680" "1452"  "80319" "23002" "1856" 
#&gt; [10] "23291" "7976"  "55366" "8549"  "6885"  "4609"  "4772"  "4776"  "64840"
#&gt; [19] "5532"  "5534"  "5567"  "5879"  "5881"  "9978"  "387"   "9475"  "84870"
#&gt; [28] "8607"  "59343" "6477"  "6907"  "57216" "80326"
#&gt; 
#&gt; $`Notch signaling pathway`
#&gt;  [1] "9541"  "54567" "1856"  "3066"  "182"   "3714"  "2648"  "8850"  "9794" 
#&gt; [10] "55534" "4854"  "5664"  "3516"  "5986" 
#&gt; 
#&gt; $`Neurotrophin signaling pathway`
#&gt;  [1] "207"   "10000" "91860" "814"   "1399"  "2309"  "10818" "11213" "3667" 
#&gt; [10] "3845"  "5604"  "4215"  "4217"  "5602"  "5600"  "5599"  "5601"  "4793" 
#&gt; [19] "4893"  "4916"  "5296"  "5335"  "5336"  "5781"  "5879"  "5906"  "387"  
#&gt; [28] "8767"  "9252"  "6272"  "6654"  "7531" 
#&gt; 
#&gt; $`Amyotrophic lateral sclerosis (ALS)`
#&gt; [1] "836"  "5608" "5600" "4747" "4741" "5532" "5534"
#&gt; </div><div class='input'>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mario Grassi, Fernando Palluzzi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


