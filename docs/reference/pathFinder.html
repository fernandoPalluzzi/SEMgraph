<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perturbed path search utility — pathFinder • SEMgraph</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perturbed path search utility — pathFinder" />
<meta property="og:description" content="This function uses SEMace to find
significant causal effects between source-sink pairs and
SEMpath to fit them and test their edge
perturbation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMgraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fernandoPalluzzi/SEMgraph/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perturbed path search utility</h1>
    <small class="dont-index">Source: <a href='https://github.com/fernandoPalluzzi/SEMgraph/blob/master/R/semUtils.R'><code>R/semUtils.R</code></a></small>
    <div class="hidden name"><code>pathFinder.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses <code><a href='SEMace.html'>SEMace</a></code> to find
significant causal effects between source-sink pairs and
<code><a href='SEMpath.html'>SEMpath</a></code> to fit them and test their edge
perturbation.</p>
    </div>

    <pre class="usage"><span class='fu'>pathFinder</span><span class='op'>(</span>
  <span class='va'>graph</span>,
  <span class='va'>data</span>,
  group <span class='op'>=</span> <span class='cn'>NULL</span>,
  ace <span class='op'>=</span> <span class='cn'>NULL</span>,
  path <span class='op'>=</span> <span class='st'>"directed"</span>,
  method <span class='op'>=</span> <span class='st'>"none"</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>graph</th>
      <td><p>Input network as an igraph object.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>group A binary vector. This vector must be as long as the
number of subjects. Each vector element must be 1 for cases and 0
for control subjects. Group specification enables edge perturbation
testing. By default, <code>group = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>ace</th>
      <td><p>A data.frame generated by <code><a href='SEMace.html'>SEMace</a></code>.
If NULL, <code><a href='SEMace.html'>SEMace</a></code> will be automatically run.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>If <code>path = "directed"</code>, all directed paths between
the two nodes will be included in the fitted model.
If <code>path = "shortest"</code>, only shortest paths will be considered.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Multiple testing correction method. One of the values
available in <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code>.
By default, <code>method = "none"</code> (i.e., no multiple test correction).</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Significance level for ACE selection (by default,
<code>alpha = 0.05</code>).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show the significant directed (or shortest) paths
inside the input graph.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of 3 objects:</p><ul>
<li><p>"paths", list of paths as igraph objects;</p></li>
<li><p>"fit", fitting results for each path as a lavaan object;</p></li>
<li><p>"dfp", a data.frame containing SEM global fitting statistics.</p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Fernando Palluzzi <a href='mailto:fernando.palluzzi@gmail.com'>fernando.palluzzi@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>

<span class='co'># Find and evaluate significantly perturbed paths</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>huge</span><span class='op'>)</span>
<span class='va'>als.npn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/huge/man/huge.npn.html'>huge.npn</a></span><span class='op'>(</span><span class='va'>alsData</span><span class='op'>$</span><span class='va'>exprs</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Conducting the nonparanormal (npn) transformation via shrunkun ECDF....done.</div><div class='input'>
<span class='va'>adjData</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SEMbap.html'>SEMbap</a></span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>als.npn</span><span class='op'>)</span><span class='op'>$</span><span class='va'>data</span>
</div><div class='output co'>#&gt; d-separation test (basis set) of 420 edges ...
#&gt; 
#&gt; Number of significant local tests: 220 / 420 
#&gt; </div><div class='input'>
<span class='va'>ace</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SEMace.html'>SEMace</a></span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>adjData</span>,
              group <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Frequency distribution of path length from X to Y :
#&gt;  1  2  3  4  5 
#&gt; 12  1  3  1  6 
#&gt; 
#&gt; 
 ACE 1 of 23
 ACE 2 of 23
 ACE 3 of 23
 ACE 4 of 23
 ACE 5 of 23
 ACE 6 of 23
 ACE 7 of 23
 ACE 8 of 23
 ACE 9 of 23
 ACE 10 of 23
 ACE 11 of 23
 ACE 12 of 23
 ACE 13 of 23
 ACE 14 of 23
 ACE 15 of 23
 ACE 16 of 23
 ACE 17 of 23
 ACE 18 of 23
 ACE 19 of 23
 ACE 20 of 23
 ACE 21 of 23
 ACE 22 of 23
 ACE 23 of 23</div><div class='input'><span class='va'>ace</span> <span class='op'>&lt;-</span> <span class='va'>ace</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>ace</span><span class='op'>$</span><span class='va'>pvalue</span><span class='op'>)</span>,<span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>ace</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    sink op source  d_est  d_se    d_z pvalue d_lower d_upper
#&gt; 9  5534 &lt;-   6647  0.723 0.199  3.633  0.000   0.333   1.112
#&gt; 14  836 &lt;-    317 -0.524 0.168 -3.120  0.002  -0.853  -0.195
#&gt; 21 4747 &lt;-   5630  0.523 0.201  2.595  0.009   0.128   0.918
#&gt; 19 4741 &lt;-   7133  0.786 0.315  2.498  0.012   0.169   1.403
#&gt; 4  4747 &lt;-   6647  0.376 0.162  2.312  0.021   0.057   0.694
#&gt; 6  5530 &lt;-   6647 -0.360 0.174 -2.063  0.039  -0.702  -0.018
#&gt; 7  5532 &lt;-   6647  0.369 0.181  2.035  0.042   0.014   0.724</div><div class='input'>
<span class='va'>paths</span> <span class='op'>&lt;-</span> <span class='fu'>pathFinder</span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>adjData</span>,
                    group <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>group</span>,
                    ace <span class='op'>=</span> <span class='va'>ace</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Found 7 significant ACEs.
#&gt; 
#&gt;   pathId sink op source N.nodes N.edges dev_df  srmr   pv.act   pv.inh
#&gt; 1     P9 5534 &lt;-   6647       2       1    NaN 0.000 0.000000 0.109027
#&gt; 2    P14  836 &lt;-    317       3       2  0.182 0.010 0.001450 0.678200
#&gt; 3    P21 4747 &lt;-   5630       2       1    Inf 0.000 0.339141 0.730509
#&gt; 4    P19 4741 &lt;-   7133      10      16  2.768 0.081 0.000002 0.000817
#&gt; 5     P4 4747 &lt;-   6647       2       1    NaN 0.000 0.635197 0.083373
#&gt; 6     P6 5530 &lt;-   6647       2       1    NaN 0.000 0.997656 0.008233</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'>parameterEstimates</span><span class='op'>(</span><span class='va'>paths</span><span class='op'>$</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>P19</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     lhs op   rhs    est    se      z pvalue ci.lower ci.upper
#&gt; 1 z1432  ~ group -0.017 0.072 -0.238  0.812   -0.157    0.123
#&gt; 2 z1616  ~ group  0.051 0.080  0.644  0.520   -0.105    0.207
#&gt; 3 z4217  ~ group  0.062 0.077  0.802  0.422   -0.089    0.213
#&gt; 4 z4741  ~ group  0.444 0.073  6.110  0.000    0.302    0.587
#&gt; 5 z5600  ~ group -0.296 0.076 -3.910  0.000   -0.445   -0.148
#&gt; 6 z5603  ~ group  0.003 0.079  0.032  0.974   -0.153    0.158</div><div class='input'><span class='fu'><a href='gplot.html'>gplot</a></span><span class='op'>(</span><span class='va'>paths</span><span class='op'>$</span><span class='va'>paths</span><span class='op'>$</span><span class='va'>P19</span><span class='op'>)</span>
</div><div class='img'><img src='pathFinder-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>path19</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SEMpath.html'>SEMpath</a></span><span class='op'>(</span>graph <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>graph</span>, data <span class='op'>=</span> <span class='va'>adjData</span>,
                  group <span class='op'>=</span> <span class='va'>alsData</span><span class='op'>$</span><span class='va'>group</span>,
                  from <span class='op'>=</span> <span class='st'>"7133"</span>,
                  to <span class='op'>=</span> <span class='st'>"4747"</span>,
                  path <span class='op'>=</span> <span class='st'>"directed"</span>,
                  verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='pathFinder-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Path: 7133 -&gt; 4747 size- 10 16 --
#&gt; 
#&gt; NLMINB solver ended normally after 11 iterations 
#&gt; 
#&gt; deviance/df: 2.607828  srmr: 0.07847445 
#&gt; 
#&gt; Brown's combined P-value of node activation: 0.3594459 
#&gt; 
#&gt; Brown's combined P-value of node inhibition: 0.0005751199 
#&gt; </div><div class='input'>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mario Grassi, Fernando Palluzzi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


