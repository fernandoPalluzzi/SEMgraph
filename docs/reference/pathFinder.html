<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perturbed path search utility — pathFinder • SEMgraph</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perturbed path search utility — pathFinder"><meta property="og:description" content="This function uses SEMace to find
significant causal effects between source-sink pairs and
SEMpath to fit them and test their edge
perturbation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SEMgraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fernandoPalluzzi/SEMgraph/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perturbed path search utility</h1>
    <small class="dont-index">Source: <a href="https://github.com/fernandoPalluzzi/SEMgraph/blob/HEAD/R/semPaths.R" class="external-link"><code>R/semPaths.R</code></a></small>
    <div class="hidden name"><code>pathFinder.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses <code><a href="SEMace.html">SEMace</a></code> to find
significant causal effects between source-sink pairs and
<code><a href="SEMpath.html">SEMpath</a></code> to fit them and test their edge
perturbation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">pathFinder</span><span class="op">(</span>
  <span class="va">graph</span>,
  <span class="va">data</span>,
  group <span class="op">=</span> <span class="cn">NULL</span>,
  ace <span class="op">=</span> <span class="cn">NULL</span>,
  path <span class="op">=</span> <span class="st">"directed"</span>,
  method <span class="op">=</span> <span class="st">"none"</span>,
  alpha <span class="op">=</span> <span class="fl">0.05</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>graph</dt>
<dd><p>Input network as an igraph object.</p></dd>
<dt>data</dt>
<dd><p>A matrix or data.frame. Rows correspond to subjects, and
columns to graph nodes (variables).</p></dd>
<dt>group</dt>
<dd><p>group A binary vector. This vector must be as long as the
number of subjects. Each vector element must be 1 for cases and 0
for control subjects. Group specification enables edge perturbation
testing. By default, <code>group = NULL</code>.</p></dd>
<dt>ace</dt>
<dd><p>A data.frame generated by <code><a href="SEMace.html">SEMace</a></code>.
If NULL, <code><a href="SEMace.html">SEMace</a></code> will be automatically run.</p></dd>
<dt>path</dt>
<dd><p>If <code>path = "directed"</code>, all directed paths between
the two nodes will be included in the fitted model.
If <code>path = "shortest"</code>, only shortest paths will be considered.</p></dd>
<dt>method</dt>
<dd><p>Multiple testing correction method. One of the values
available in <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>.
By default, <code>method = "none"</code> (i.e., no multiple test correction).</p></dd>
<dt>alpha</dt>
<dd><p>Significance level for ACE selection (by default,
<code>alpha = 0.05</code>).</p></dd>
<dt>verbose</dt>
<dd><p>Show the significant directed (or shortest) paths
inside the input graph.</p></dd>
<dt>...</dt>
<dd><p>Currently ignored.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of 3 objects:</p><ul><li><p>"paths", list of paths as igraph objects;</p></li>
<li><p>"fit", fitting results for each path as a lavaan object;</p></li>
<li><p>"dfp", a data.frame containing SEM global fitting statistics.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Fernando Palluzzi <a href="mailto:fernando.palluzzi@gmail.com">fernando.palluzzi@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Find and evaluate significantly perturbed paths</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">huge</span><span class="op">)</span></span>
<span class="r-in"><span class="va">als.npn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/huge/man/huge.npn.html" class="external-link">huge.npn</a></span><span class="op">(</span><span class="va">alsData</span><span class="op">$</span><span class="va">exprs</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conducting the nonparanormal (npn) transformation via shrunkun ECDF....done.</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">adjData</span> <span class="op">&lt;-</span> <span class="fu"><a href="SEMbap.html">SEMbap</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">als.npn</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d-separation test (basis set) of 420 edges...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  / 0 % elapsed=00s    - 1 % elapsed=00s, remaining~01s \ 2 % elapsed=00s, remaining~00s | 4 % elapsed=00s, remaining~01s / 5 % elapsed=00s, remaining~01s - 6 % elapsed=00s, remaining~01s \ 7 % elapsed=00s, remaining~01s | 8 % elapsed=00s, remaining~01s / 10% elapsed=00s, remaining~01s - 11% elapsed=00s, remaining~01s \ 12% elapsed=00s, remaining~01s | 13% elapsed=00s, remaining~01s / 14% elapsed=00s, remaining~01s - 15% elapsed=00s, remaining~01s \ 17% elapsed=00s, remaining~01s | 18% elapsed=00s, remaining~01s / 19% elapsed=00s, remaining~01s - 20% elapsed=00s, remaining~01s \ 21% elapsed=00s, remaining~01s | 23% elapsed=00s, remaining~01s / 24% elapsed=00s, remaining~01s - 25% elapsed=00s, remaining~01s \ 26% elapsed=00s, remaining~01s | 27% elapsed=00s, remaining~01s / 29% elapsed=00s, remaining~01s - 30% elapsed=00s, remaining~01s \ 31% elapsed=00s, remaining~01s | 32% elapsed=00s, remaining~01s / 33% elapsed=00s, remaining~01s - 35% elapsed=00s, remaining~01s \ 36% elapsed=00s, remaining~01s | 37% elapsed=00s, remaining~01s / 38% elapsed=00s, remaining~01s - 39% elapsed=00s, remaining~01s \ 40% elapsed=00s, remaining~01s | 42% elapsed=00s, remaining~01s / 43% elapsed=00s, remaining~01s - 44% elapsed=00s, remaining~01s \ 45% elapsed=00s, remaining~01s | 46% elapsed=00s, remaining~01s / 48% elapsed=00s, remaining~00s - 49% elapsed=00s, remaining~00s \ 50% elapsed=00s, remaining~00s | 51% elapsed=00s, remaining~00s / 52% elapsed=00s, remaining~00s - 54% elapsed=00s, remaining~00s \ 55% elapsed=01s, remaining~00s | 56% elapsed=01s, remaining~00s / 57% elapsed=01s, remaining~00s - 58% elapsed=01s, remaining~00s \ 60% elapsed=01s, remaining~00s | 61% elapsed=01s, remaining~00s / 62% elapsed=01s, remaining~00s - 63% elapsed=01s, remaining~00s \ 64% elapsed=01s, remaining~00s | 65% elapsed=01s, remaining~00s / 67% elapsed=01s, remaining~00s - 68% elapsed=01s, remaining~00s \ 69% elapsed=01s, remaining~00s | 70% elapsed=01s, remaining~00s / 71% elapsed=01s, remaining~00s - 73% elapsed=01s, remaining~00s \ 74% elapsed=01s, remaining~00s | 75% elapsed=01s, remaining~00s / 76% elapsed=01s, remaining~00s - 77% elapsed=01s, remaining~00s \ 79% elapsed=01s, remaining~00s | 80% elapsed=01s, remaining~00s / 81% elapsed=01s, remaining~00s - 82% elapsed=01s, remaining~00s \ 83% elapsed=01s, remaining~00s | 85% elapsed=01s, remaining~00s / 86% elapsed=01s, remaining~00s - 87% elapsed=01s, remaining~00s \ 88% elapsed=01s, remaining~00s | 89% elapsed=01s, remaining~00s / 90% elapsed=01s, remaining~00s - 92% elapsed=01s, remaining~00s \ 93% elapsed=01s, remaining~00s | 94% elapsed=01s, remaining~00s / 95% elapsed=01s, remaining~00s - 96% elapsed=01s, remaining~00s \ 98% elapsed=01s, remaining~00s | 99% elapsed=01s, remaining~00s / 100% elapsed=01s, remaining~00s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of significant local tests: 220 / 420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ace</span> <span class="op">&lt;-</span> <span class="fu"><a href="SEMace.html">SEMace</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">adjData</span>,</span>
<span class="r-in">              group <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Frequency distribution of path length from X to Y :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3  4  5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  1  3  1  6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ACE 1 of 23 ACE 2 of 23 ACE 3 of 23 ACE 4 of 23 ACE 5 of 23 ACE 6 of 23 ACE 7 of 23 ACE 8 of 23 ACE 9 of 23 ACE 10 of 23 ACE 11 of 23 ACE 12 of 23 ACE 13 of 23 ACE 14 of 23 ACE 15 of 23 ACE 16 of 23 ACE 17 of 23 ACE 18 of 23 ACE 19 of 23 ACE 20 of 23 ACE 21 of 23 ACE 22 of 23 ACE 23 of 23</span>
<span class="r-in"><span class="va">ace</span> <span class="op">&lt;-</span> <span class="va">ace</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">ace</span><span class="op">$</span><span class="va">pvalue</span><span class="op">)</span>,<span class="op">]</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ace</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sink op source  d_est  d_se    d_z pvalue d_lower d_upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  5534 &lt;-   6647  0.723 0.199  3.633  0.000   0.333   1.112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  836 &lt;-    317 -0.524 0.168 -3.120  0.002  -0.853  -0.195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 4747 &lt;-   5630  0.523 0.201  2.595  0.009   0.128   0.918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 4741 &lt;-   7133  0.786 0.315  2.498  0.012   0.169   1.403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  4747 &lt;-   6647  0.376 0.162  2.312  0.021   0.057   0.694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  5530 &lt;-   6647 -0.360 0.174 -2.063  0.039  -0.702  -0.018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  5532 &lt;-   6647  0.369 0.181  2.035  0.042   0.014   0.724</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu">pathFinder</span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">adjData</span>,</span>
<span class="r-in">                    group <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">group</span>,</span>
<span class="r-in">                    ace <span class="op">=</span> <span class="va">ace</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found 7 significant ACEs.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pathId sink op source N.nodes N.edges dev_df  srmr   pv.act   pv.inh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    P14  836 &lt;-    317       3       2  0.182 0.010 0.001450 0.678200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    P19 4741 &lt;-   7133      10      16  2.768 0.081 0.000002 0.000817</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">parameterEstimates</span><span class="op">(</span><span class="va">paths</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">P19</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lhs op   rhs    est    se      z pvalue ci.lower ci.upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 z317  ~ group  0.201 0.077  2.590  0.010    0.049    0.352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 z836  ~ group  0.200 0.078  2.575  0.010    0.048    0.352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 z842  ~ group -0.087 0.080 -1.092  0.275   -0.245    0.070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 z836  ~  z842  0.062 0.078  0.804  0.422   -0.090    0.214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 z842  ~  z317  0.101 0.080  1.265  0.206   -0.056    0.258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 z317 ~~  z317  0.954 0.107  8.944  0.000    0.745    1.163</span>
<span class="r-in"><span class="fu"><a href="gplot.html">gplot</a></span><span class="op">(</span><span class="va">paths</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">P19</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pathFinder-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">path19</span> <span class="op">&lt;-</span> <span class="fu"><a href="SEMpath.html">SEMpath</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">graph</span>, data <span class="op">=</span> <span class="va">adjData</span>,</span>
<span class="r-in">                  group <span class="op">=</span> <span class="va">alsData</span><span class="op">$</span><span class="va">group</span>,</span>
<span class="r-in">                  from <span class="op">=</span> <span class="st">"7133"</span>,</span>
<span class="r-in">                  to <span class="op">=</span> <span class="st">"4747"</span>,</span>
<span class="r-in">                  path <span class="op">=</span> <span class="st">"directed"</span>,</span>
<span class="r-in">                  verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pathFinder-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Path: 7133 -&gt; 4747 size- 10 16 --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NLMINB solver ended normally after 6 iterations </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> deviance/df: 2.607828  srmr: 0.07847444 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Brown's combined P-value of node activation: 0.3594458 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Brown's combined P-value of node inhibition: 0.0005751165 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mario Grassi, Fernando Palluzzi, Barbara Tarantino.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

